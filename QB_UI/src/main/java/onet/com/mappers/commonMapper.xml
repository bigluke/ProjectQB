<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="onet.com.common.dao.CommonDao">
<!-- 한결 10월 12일 공지사항 및 시험일정(강사 학생 메인페이지) 시작 -->
<select id="notice" parameterType="String" resultType="onet.com.vo.NoticeDto">
   select * from notice where class_name = (select class_name from member where member_id = #{member_id});
</select>
<select id="exam_info" parameterType="String" resultType="onet.com.vo.Exam_infoDto">
   select * from exam_info where class_name = (select class_name from member where member_id = #{member_id});
</select>
<!-- 한결 10월 12일 공지사항 및 시험일정(강사 학생 메인페이지) 끝 -->

<!-- 민지 10.19 관리자 공지사하 및 시험일정시작 -->
<select id="adminnotice" parameterType="onet.com.vo.NoticeDto" resultType="onet.com.vo.NoticeDto">
	select * from notice where class_name = #{class_name}
</select>
<select id="adminexam_info" parameterType="onet.com.vo.ExamInfoDto" resultType="onet.com.vo.ExamInfoDto">
	select * from exam_info where class_name = #{class_name}
</select>
<!-- 민지 10.19 관리자 공지사하 및 시험일정 끝 -->

<!-- 한결 10월 12일 공지사항 및 시험일정(강사 학생 메인페이지) 끝 -->


<!-- 현이 10.15 examScheduleDetail 페이지 select 시작 -->
<select id="examScheduleDetail" parameterType="int" resultType="onet.com.vo.ExamInfoDto">
	select exam_info_num, exam_paper_num, class_name, exam_info_name, exam_info_desc, exam_info_member, 
	exam_info_date, exam_info_start, exam_info_end, exam_info_time 
	from exam_info where exam_info_num = #{exam_info_num}
</select>
<!-- 현이 10.15 examScheduleDetail 페이지 select 끝 -->


<!-- 양회준 10.15 내 정보 수정 시작 -->
<select id="myPageInfo" resultType="onet.com.vo.MemberDto">
	select * from member where member_id = #{member_id}
</select>

<update id="myPageUpdate" parameterType="onet.com.vo.MemberDto">
 	UPDATE member 
	SET 
	member_pwd=#{member_pwd},
	member_name=#{member_name},
	member_email=#{member_email},	
	member_phone=#{member_phone}
	where member_id=#{member_id}
</update>

<update id="myPageDrop" parameterType="onet.com.vo.MemberDto">
 	UPDATE member 
	SET 
	member_enable=#{member_enable}
	where member_id=#{member_id}
</update>

<!-- 양회준 10.15 내 정보 수정 끝 -->


<select id="memberDrop" resultType="int">
	select count(*) from member where member_id = #{param1} and member_pwd = #{param2}
</select>

<!-- 현이 - ExamPaperDo 10.18 시작 -->
<select id="examPaperDoQuestion" parameterType="int" resultType="onet.com.vo.ExamPaperDoQuestionDto"><!-- 문제 정보 가져오기 -->
	select q.question_num, q.question_type, q.question_name, q.question_img, q.question_answer, 
	eq.exam_question_seq, eq.exam_question_score 
	from question q join exam_question eq
	on (q.question_num = eq.question_num)
	where eq.exam_paper_num = 
	(select exam_paper_num from exam_info where exam_info_num = #{exam_info_num})
	order by eq.exam_question_seq
</select>

<select id="examPaperDoQuestion_choice" parameterType="int" resultType="onet.com.vo.Question_choiceDto"><!-- 문제 보기 가져오기 -->
	select question_num, question_choice_num, question_choice_content, question_choice_image 
	from question_choice
	where question_num in 	
	(select q.question_num
	from question q join exam_question eq
	on (q.question_num = eq.question_num)
	where eq.exam_paper_num = 
	(select exam_paper_num from exam_info 
	where exam_info_num = #{exam_info_num})
	)
	order by question_num, question_choice_num
</select>

<select id="questionCount" parameterType="int" resultType="int"><!-- 한 시험지에 담긴 문제의 개수 -->
	select count(*) as questionCount
	from exam_question
	where exam_paper_num = (select exam_paper_num from exam_info where exam_info_num = #{exam_info_num})
</select>
<!-- 현이 - ExamPaperDo 10.18 끝 -->


<!-- 재훈 - 문제관리 관련 10.21 시작 -->
<select id="singleQuestionDeleteSearch" parameterType="int" resultType="onet.com.vo.ExamQuestionDto">
	select * from exam_question where question_num = #{question_num}
</select>
<delete id="singleQuestionDelete" parameterType="onet.com.vo.QuestionDto">
	delete from question where question_num = #{question_num}
</delete>
<delete id="singleQuestionChoiceDelete" parameterType="onet.com.vo.Question_choiceDto">
	delete from question_choice where question_num = #{question_num}
</delete>

<!-- 재훈 - 문제관리 관련 10.21 끝 -->
</mapper>